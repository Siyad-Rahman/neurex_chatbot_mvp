{"version":3,"file":"chatbot.umd.js","sources":["../src/core/chat_logic.js","../src/ui/chat_ui.js","../src/chatbot.js"],"sourcesContent":["// src/core/chat_logic.js\nexport class ChatCore {\n  constructor({ apiUrl, onSend, onMessage, orgKey, removeMessage } = {}) {\n    this.apiUrl = apiUrl; // backend endpoint\n    this.messages = [];\n    this.onSend = onSend;\n    this.onMessage = onMessage;\n    this.orgKey = orgKey;\n    this.removeMessage = removeMessage;\n  }\n\n  async sendMessage(text) {\n    if (!text.trim()) return;\n\n    const userMsg = { text, sender: \"user\", ts: Date.now() };\n    this.messages.push(userMsg);\n    this.onSend?.(userMsg);\n\n    this.addLoading();\n    function sleep(ms) {\n      return new Promise((resolve) => setTimeout(resolve, ms));\n    }\n\n    try {\n      const res = await fetch(\"http://192.168.29.14:3000/api/v1/chatbot\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          message: text,\n          lang: \"en\",\n          orgKey: this.orgKey,\n        }),\n      });\n\n      if (!res.ok) throw new Error(`HTTP ${res.status}`);\n\n      const data = await res.json();\n      // Validate response structure\n      const botReply = data?.message || \"🤖 No reply from bot\";\n\n      const botMsg = { text: botReply, sender: \"bot\", ts: Date.now() };\n      this.removeLoading();\n      //   this.messages.push(botMsg);\n      this.receiveMessage(botMsg.text);\n    } catch (err) {\n      const errMsg = {\n        text: `⚠️ Oops something went wrong`,\n        sender: \"system\",\n        ts: Date.now(),\n        error: `${err.message}`,\n      };\n      console.log(errMsg);\n      this.removeLoading();\n      //   this.messages.push(errMsg);\n      this.receiveMessage(errMsg.text);\n    }\n\n    return userMsg;\n  }\n\n  addLoading() {\n    const loadingMessage = {\n      text: \"...\",\n      sender: \"bot\",\n      ts: Date.now(),\n      type: \"loading\",\n    };\n    this.messages.push(loadingMessage);\n    this.onMessage?.(loadingMessage);\n  }\n\n  removeLoading() {\n    this.messages = this.messages.filter((msg) => msg.type !== \"loading\");\n    this.removeMessage({ type: \"loading\" });\n  }\n\n  receiveMessage(text) {\n    const botMsg = { text, sender: \"bot\", ts: Date.now() };\n    this.messages.push(botMsg);\n    this.onMessage?.(botMsg);\n    return botMsg;\n  }\n\n  getHistory() {\n    return [...this.messages];\n  }\n}\n","// src/ui/chat_ui.js\nexport class ChatUI {\n  constructor(core) {\n    this.core = core;\n    this.container = null;\n    this.messagesEl = null;\n    this.inputEl = null;\n  }\n\n  init() {\n    if (document.getElementById(\"neurex-widget\")) return;\n\n    // container\n    this.container = document.createElement(\"div\");\n    this.container.id = \"neurex-widget\";\n\n    Object.assign(this.container.style, {\n      position: \"fixed\",\n      bottom: \"20px\",\n      right: \"20px\",\n      width: \"280px\",\n      background: \"#1e1e1e\",\n      color: \"#fff\",\n      borderRadius: \"12px\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      fontFamily: \"Arial, sans-serif\",\n      maxHeight: \"420px\",\n      boxShadow: \"0 6px 20px rgba(0,0,0,0.5)\",\n      overflow: \"hidden\", // keeps rounded corners clean\n    });\n\n    // header\n    const header = document.createElement(\"div\");\n    header.innerText = \"Chat with Neurex\";\n    Object.assign(header.style, {\n      padding: \"10px 12px\",\n      background: \"linear-gradient(135deg, #333, #222)\",\n      color: \"#fff\",\n      fontSize: \"15px\",\n      fontWeight: \"600\",\n      borderBottom: \"1px solid #333\",\n      textAlign: \"center\",\n      letterSpacing: \"0.5px\",\n    });\n    this.container.appendChild(header);\n\n    // messages\n    this.messagesEl = document.createElement(\"div\");\n    Object.assign(this.messagesEl.style, {\n      flex: \"1\",\n      overflowY: \"auto\",\n      padding: \"10px\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      gap: \"8px\",\n      scrollbarWidth: \"thin\",\n      scrollbarColor: \"#666 #1e1e1e\",\n    });\n    this.container.appendChild(this.messagesEl);\n\n    // input wrapper\n    const inputWrapper = document.createElement(\"div\");\n    Object.assign(inputWrapper.style, {\n      display: \"flex\",\n      alignItems: \"center\",\n      padding: \"8px\",\n      background: \"#2a2a2a\",\n      borderTop: \"1px solid #333\",\n    });\n\n    // input field\n    this.inputEl = document.createElement(\"input\");\n    this.inputEl.placeholder = \"Type a message...\";\n    Object.assign(this.inputEl.style, {\n      flex: \"1\",\n      padding: \"8px 12px\",\n      borderRadius: \"20px\",\n      border: \"1px solid #444\",\n      background: \"#1e1e1e\",\n      color: \"#fff\",\n      fontSize: \"13px\",\n      outline: \"none\",\n    });\n\n    // send button\n    const sendBtn = document.createElement(\"button\");\n    sendBtn.innerText = \"➤\";\n    Object.assign(sendBtn.style, {\n      marginLeft: \"8px\",\n      background: \"#4a90e2\",\n      border: \"none\",\n      color: \"#fff\",\n      borderRadius: \"50%\",\n      width: \"34px\",\n      height: \"34px\",\n      cursor: \"pointer\",\n      fontSize: \"14px\",\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      transition: \"background 0.2s\",\n    });\n    sendBtn.onmouseover = () => (sendBtn.style.background = \"#3a78c2\");\n    sendBtn.onmouseleave = () => (sendBtn.style.background = \"#4a90e2\");\n\n    inputWrapper.appendChild(this.inputEl);\n    inputWrapper.appendChild(sendBtn);\n    this.container.appendChild(inputWrapper);\n\n    // events\n    const sendMessage = () => {\n      if (this.inputEl.value.trim()) {\n        this.core.sendMessage(this.inputEl.value);\n        this.inputEl.value = \"\";\n      }\n    };\n    this.inputEl.addEventListener(\"keydown\", (e) => {\n      if (e.key === \"Enter\") sendMessage();\n    });\n    sendBtn.addEventListener(\"click\", sendMessage);\n\n    document.body.appendChild(this.container);\n\n    // subscribe to core\n    this.core.onSend = (msg) => this.addMessage(msg);\n    this.core.onMessage = (msg) => this.addMessage(msg);\n    this.core.removeMessage = (msg) => this.removeMessage(msg);\n  }\n\n  removeMessage({ type }) {\n    if (type === \"loading\") {\n      const loadingBubbles =\n        this.messagesEl.querySelectorAll(\".loading-bubble\");\n      loadingBubbles.forEach((bubble) => bubble.remove());\n    }\n  }\n\n  addMessage({ text, sender, type }) {\n    const bubble = document.createElement(\"div\");\n    bubble.innerText = text;\n\n    if (sender === \"bot\" && text === \"...\") {\n      bubble.classList.add(\"loading-bubble\");\n      bubble.innerText = \"…\"; // Typing indicator\n    } else {\n      bubble.innerText = text;\n    }\n\n    Object.assign(bubble.style, {\n      maxWidth: \"80%\",\n      alignSelf: sender === \"user\" ? \"flex-end\" : \"flex-start\",\n      background:\n        sender === \"user\"\n          ? \"linear-gradient(135deg, #4a90e2, #357ab7)\"\n          : \"#2f2f2f\",\n      color: \"#fff\",\n      padding: \"8px 12px\",\n      borderRadius: sender === \"user\" ? \"16px 16px 0 16px\" : \"16px 16px 16px 0\",\n      fontSize: \"13px\",\n      lineHeight: \"1.4\",\n      boxShadow: \"0 2px 6px rgba(0,0,0,0.3)\",\n      wordBreak: \"break-word\",\n      fontStyle: type ? \"italic\" : \"normal\",\n      opacity: type ? \"0.7\" : \"1\",\n    });\n\n    this.messagesEl.appendChild(bubble);\n    this.messagesEl.scrollTop = this.messagesEl.scrollHeight;\n\n    return bubble;\n  }\n}\n","// src/chatbot.js\nimport { ChatCore } from \"./core/chat_logic.js\";\nimport { ChatUI } from \"./ui/chat_ui.js\";\n\nfunction initWidget({ key } = {}) {\n  const core = new ChatCore({ orgKey: key });\n  const ui = new ChatUI(core);\n  ui.init();\n\n  // Example: default bot reply\n  core.onSend = (msg) => {\n    ui.addMessage(msg); // render user msg\n    // setTimeout(() => core.receiveMessage(\"Echo: \" + msg.text), 600);\n  };\n\n  return { core, ui };\n}\n\nif (typeof window !== \"undefined\") {\n  window.NeurexChatBot = { initWidget };\n}\n\nexport { initWidget };\n"],"names":["ChatCore","constructor","apiUrl","onSend","onMessage","orgKey","removeMessage","this","messages","sendMessage","text","trim","userMsg","sender","ts","Date","now","push","addLoading","res","fetch","method","headers","body","JSON","stringify","message","lang","ok","Error","status","data","json","botMsg","removeLoading","receiveMessage","err","errMsg","error","console","log","loadingMessage","type","filter","msg","getHistory","ChatUI","core","container","messagesEl","inputEl","init","document","getElementById","createElement","id","Object","assign","style","position","bottom","right","width","background","color","borderRadius","display","flexDirection","fontFamily","maxHeight","boxShadow","overflow","header","innerText","padding","fontSize","fontWeight","borderBottom","textAlign","letterSpacing","appendChild","flex","overflowY","gap","scrollbarWidth","scrollbarColor","inputWrapper","alignItems","borderTop","placeholder","border","outline","sendBtn","marginLeft","height","cursor","justifyContent","transition","onmouseover","onmouseleave","value","addEventListener","e","key","addMessage","querySelectorAll","forEach","bubble","remove","classList","add","maxWidth","alignSelf","lineHeight","wordBreak","fontStyle","opacity","scrollTop","scrollHeight","initWidget","ui","window","NeurexChatBot"],"mappings":"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"}