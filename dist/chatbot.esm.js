class e{constructor({apiUrl:e,onSend:t,onMessage:s,orgKey:n,removeMessage:i}={}){this.apiUrl=e,this.messages=[],this.onSend=t,this.onMessage=s,this.orgKey=n,this.removeMessage=i}async sendMessage(e){if(!e.trim())return;const t={text:e,sender:"user",ts:Date.now()};this.messages.push(t),this.onSend?.(t),this.addLoading();try{const t=await fetch("http://192.168.29.14:3000/api/v1/chatbot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,lang:"en",orgKey:this.orgKey})});if(!t.ok)throw new Error(`HTTP ${t.status}`);const s=await t.json(),n={text:s?.message||"🤖 No reply from bot",sender:"bot",ts:Date.now()};this.removeLoading(),this.receiveMessage(n.text)}catch(e){const t={text:"⚠️ Oops something went wrong",sender:"system",ts:Date.now(),error:`${e.message}`};console.log(t),this.removeLoading(),this.receiveMessage(t.text)}return t}addLoading(){const e={text:"...",sender:"bot",ts:Date.now(),type:"loading"};this.messages.push(e),this.onMessage?.(e)}removeLoading(){this.messages=this.messages.filter(e=>"loading"!==e.type),this.removeMessage({type:"loading"})}receiveMessage(e){const t={text:e,sender:"bot",ts:Date.now()};return this.messages.push(t),this.onMessage?.(t),t}getHistory(){return[...this.messages]}}class t{constructor(e){this.core=e,this.container=null,this.messagesEl=null,this.inputEl=null}init(){if(document.getElementById("neurex-widget"))return;this.container=document.createElement("div"),this.container.id="neurex-widget",Object.assign(this.container.style,{position:"fixed",bottom:"20px",right:"20px",width:"280px",background:"#1e1e1e",color:"#fff",borderRadius:"12px",display:"flex",flexDirection:"column",fontFamily:"Arial, sans-serif",maxHeight:"420px",boxShadow:"0 6px 20px rgba(0,0,0,0.5)",overflow:"hidden"});const e=document.createElement("div");e.innerText="Chat with Neurex",Object.assign(e.style,{padding:"10px 12px",background:"linear-gradient(135deg, #333, #222)",color:"#fff",fontSize:"15px",fontWeight:"600",borderBottom:"1px solid #333",textAlign:"center",letterSpacing:"0.5px"}),this.container.appendChild(e),this.messagesEl=document.createElement("div"),Object.assign(this.messagesEl.style,{flex:"1",overflowY:"auto",padding:"10px",display:"flex",flexDirection:"column",gap:"8px",scrollbarWidth:"thin",scrollbarColor:"#666 #1e1e1e"}),this.container.appendChild(this.messagesEl);const t=document.createElement("div");Object.assign(t.style,{display:"flex",alignItems:"center",padding:"8px",background:"#2a2a2a",borderTop:"1px solid #333"}),this.inputEl=document.createElement("input"),this.inputEl.placeholder="Type a message...",Object.assign(this.inputEl.style,{flex:"1",padding:"8px 12px",borderRadius:"20px",border:"1px solid #444",background:"#1e1e1e",color:"#fff",fontSize:"13px",outline:"none"});const s=document.createElement("button");s.innerText="➤",Object.assign(s.style,{marginLeft:"8px",background:"#4a90e2",border:"none",color:"#fff",borderRadius:"50%",width:"34px",height:"34px",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s"}),s.onmouseover=()=>s.style.background="#3a78c2",s.onmouseleave=()=>s.style.background="#4a90e2",t.appendChild(this.inputEl),t.appendChild(s),this.container.appendChild(t);const n=()=>{this.inputEl.value.trim()&&(this.core.sendMessage(this.inputEl.value),this.inputEl.value="")};this.inputEl.addEventListener("keydown",e=>{"Enter"===e.key&&n()}),s.addEventListener("click",n),document.body.appendChild(this.container),this.core.onSend=e=>this.addMessage(e),this.core.onMessage=e=>this.addMessage(e),this.core.removeMessage=e=>this.removeMessage(e)}removeMessage({type:e}){if("loading"===e){this.messagesEl.querySelectorAll(".loading-bubble").forEach(e=>e.remove())}}addMessage({text:e,sender:t,type:s}){const n=document.createElement("div");return n.innerText=e,console.log("loadingloadingloading",s),"bot"===t&&"..."===e?(n.classList.add("loading-bubble"),n.innerText="…"):n.innerText=e,Object.assign(n.style,{maxWidth:"80%",alignSelf:"user"===t?"flex-end":"flex-start",background:"user"===t?"linear-gradient(135deg, #4a90e2, #357ab7)":"#2f2f2f",color:"#fff",padding:"8px 12px",borderRadius:"user"===t?"16px 16px 0 16px":"16px 16px 16px 0",fontSize:"13px",lineHeight:"1.4",boxShadow:"0 2px 6px rgba(0,0,0,0.3)",wordBreak:"break-word",fontStyle:s?"italic":"normal",opacity:s?"0.7":"1"}),this.messagesEl.appendChild(n),this.messagesEl.scrollTop=this.messagesEl.scrollHeight,n}}function s({key:s}={}){const n=new e({orgKey:s}),i=new t(n);return i.init(),n.onSend=e=>{i.addMessage(e)},{core:n,ui:i}}"undefined"!=typeof window&&(window.NeurexChatBot={initWidget:s});export{s as initWidget};
//# sourceMappingURL=chatbot.esm.js.map
